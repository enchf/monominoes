function Monominoes(){}Monominoes.util={},Monominoes.tags={},Monominoes.renders={},void 0===window.M&&(window.M=Monominoes),Monominoes.util.format=function(){for(var e=1;e<arguments.length;e++)null==arguments[e]&&(arguments[e]=""+arguments[e]);return $.validator.format.apply(null,arguments)},Monominoes.util.self=function(e){return e},Monominoes.util.concrete=function(e,n){return Komunalne.util.isFunction(e)?e.apply(n,Array.prototype.slice.call(arguments,2)):e},Monominoes.util.isRender=function(e,n){var t=!1,o=[],i=n||Monominoes.Render;if(i!==Monominoes.Render&&!Monominoes.util.isRender(i))throw"Type comparison against a non Render type";for(;!(t||null==e||null==e["class"]||o.indexOf(e["class"])>=0);)o.push(e["class"]),t=e["class"]===i&&(e===i||Komunalne.util.isInstanceOf(e,i)),e=e.superclass;return t},Monominoes.util.isRenderInstance=function(e,n){return Monominoes.util.isRender(e,n)&&!Komunalne.util.isFunction(e)},Monominoes.util.data=function(e,n,t){return t},Monominoes.util.property=function(e){return function(n,t,o){return Komunalne.util.path(o,e)}},Monominoes.util.bindFunctions=function(e,n){var t=function(t,o){Komunalne.util.isFunction(t)&&!Monominoes.util.isRender(t)&&(n[o]=t.bind(e))};Komunalne.util.forEach(n,t)},Monominoes.util.extractValue=function(e,n,t,o){var i=function(e,n,t,o){var i,s;return"path"in e?(s="absolute"in e&&e.absolute===!0?n.data:o,i=Komunalne.util.path(s,e.path)):i=o,e.handler?e.handler.call(n,n,t,i):Monominoes.util.extractValue(i,n,t,i)};return null==e?null:Komunalne.util.isAnyOf(typeof e,"string","boolean","number")?e:Komunalne.util.isFunction(e)?e.call(n,n,t,o):Komunalne.util.isInstanceOf(e,Object)?i(e,n,t,o):e.toString()},Monominoes.Render=function(){},Monominoes.Render.prototype.data=null,Monominoes.Render.prototype.path=null,Monominoes.Render.prototype.iterable=!1,Monominoes.Render.prototype.items=null,Monominoes.Render.prototype.defaults=null,Monominoes.Render.prototype.config=null,Monominoes.Render.prototype.layout=null,Monominoes.Render.prototype.key=null,Monominoes.Render.prototype.parent=null,Monominoes.Render.prototype.baseRender=null,Monominoes.Render.prototype.name="Render",Monominoes.Render.prototype.skipProperties=["config","children"],Monominoes.Render.prototype["class"]=Monominoes.Render,Monominoes.Render.prototype.superclass=null,Monominoes.Render.prototype["super"]=null,Monominoes.Render["class"]=Monominoes.Render,Monominoes.Render.superclass=null,Monominoes.Item=function(e,n,t){this.reset(),this.container=Monominoes.Item.getContainerFrom(e),this.render=n,this.data=t,this.layout=n.layout.children,this.parent=Komunalne.util.isInstanceOf(e,Monominoes.Item)?e:null},Monominoes.Item.prototype.container=null,Monominoes.Item.prototype.render=null,Monominoes.Item.prototype.data=null,Monominoes.Item.prototype.layout=null,Monominoes.Item.prototype.children=null,Monominoes.Item.prototype.childMap=null,Monominoes.Item.prototype.item=null,Monominoes.Item.prototype.parent=null,Monominoes.Item.prototype.index=null,Monominoes.Item.prototype.reset=function(){var e;this.children&&(e=function(e){e.forEach(function(e){e.reset()})},this.children.forEach(e)),this.children=[],this.item&&this.item.remove(),this.item=null,this.childMap={},this.container=null,this.parent=null},Monominoes.Item.prototype.setIndex=function(e){this.index=e},Monominoes.Item.prototype.isDrawn=function(){return Komunalne.util.isInstanceOf(this.item,jQuery)},Monominoes.Item.prototype.draw=function(){this.item=this.render.buildItem(this.data,this),this.render.customize(this),this.container&&this.container.append(this.item),this.drawChildren()},Monominoes.Item.prototype.drawChildren=function(){var e,n,t,o,i,s;for(i=new Komunalne.helper.Iterator(this.layout);i.hasNext();)for(e=i.next(),n=e.extractData(this.data),n=e.isIterable()?n:[n],s=new Komunalne.helper.Iterator(n),this.children.push([]),e.key&&(this.childMap[e.key]=[]),t=this.children.length-1;s.hasNext();)o=new Monominoes.Item(this,e,s.next()),this.children[t].push(o),o.setIndex(this.children[t].length-1),e.key&&this.childMap[e.key].push(o),o.draw()},Monominoes.Item.getContainerFrom=function(e){var n;return Komunalne.util.isInstanceOf(e,"string")?(n=$(e)).length>0?$($(n).get(0)):null:Komunalne.util.isInstanceOf(e,jQuery)?e:e instanceof Element?$(e):Komunalne.util.isInstanceOf(e,Monominoes.Item)?e.isDrawn()?e.item:null:Monominoes.util.isRenderInstance(e)&&e.isBuilt()?e.items[0].item:null},Monominoes.Render.prototype.init=function(e){return e=e||{},this.populateDefaults(),this.applyConfig(e),this.buildSuper(),this.preInit(),this.buildLayout(),this.postInit(),null!=this.data&&this.updateGlobalData(),this},Monominoes.Render.prototype.isIterable=function(){return this.iterable===!0},Monominoes.Render.prototype.isAbsolute=function(){return this.absolute===!0},Monominoes.Render.prototype.isBuilt=function(){return Komunalne.util.isArray(this.items)&&Komunalne.util.isInstanceOf(this.items[0],Monominoes.Item)},Monominoes.Render.prototype.populateDefaults=function(){this.defaults={},Komunalne.util.clone(this,{into:this.defaults,deep:!0}),Monominoes.util.bindFunctions(this,this.defaults)},Monominoes.Render.prototype.applyConfig=function(e){e=e||{},Komunalne.util.clone(e,{into:this,deep:!0,skip:this.skipProperties}),this.config=e},Monominoes.Render.prototype.buildSuper=function(){var e,n;for(e=this["class"],n=this;e.superclass;)n["super"]={},Komunalne.util.clone(e.superclass.prototype,{deep:!0,into:n["super"]}),Monominoes.util.bindFunctions(this,n["super"]),e=e.superclass,n=n["super"]},Monominoes.Render.prototype.preInit=function(){},Monominoes.Render.prototype.buildLayout=function(){var e,n,t=this.config.children;if(this.layout={},this.layout.children=[],this.layout.childMap={},Komunalne.util.isArray(t))for(e=new Komunalne.helper.Iterator(t);e.hasNext();)n=e.next(),n=Monominoes.util.isRender(n)?Monominoes.util.concrete(n):Komunalne.util.isInstanceOf(n,Object)&&Monominoes.util.isRender(n.render)?Komunalne.util.isFunction(n.render)?n.render(n.config):n.render:null,n&&(this.layout.children.push(n),n.key&&(this.layout.childMap[n.key]=n),n.parent=this)},Monominoes.Render.prototype.postInit=function(){},Monominoes.Render.prototype.render=function(e,n){return this.updateGlobalData(e),this.createItems(n),this},Monominoes.Render.prototype.remote=function(e,n){var t=this.render.bind(this);return $.getJSON(e,function(e){t(e,n)})},Monominoes.Render.prototype.updateGlobalData=function(e){if(this.data=e=e||this.data,null==this.data)throw"No global data specified";this.layout.children.forEach(function(n){n.updateGlobalData(e)})},Monominoes.Render.prototype.createItems=function(e){var n,t,o;for(this.clear(),this.items=[],n=this.extractData(),n=this.isIterable()?n:[n],t=new Komunalne.helper.Iterator(n);t.hasNext();)o=new Monominoes.Item(e,this,t.next()),o.setIndex(t.currentKey()),this.items.push(o),o.draw()},Monominoes.Render.prototype.extractData=function(e){var n;return n=this.isAbsolute()||null==e?this.data:e,this.path?Komunalne.util.path(n,this.path):n},Monominoes.Render.prototype.clear=function(){this.items&&this.items.forEach(function(e){e.reset()}),this.items=null},Monominoes.Render.prototype.buildItem=function(e,n){throw"M.Render.buildItem should be overriden by subclass Render"},Monominoes.Render.prototype.getMappedRender=function(e){return this.layout.childMap[e]},Monominoes.Render.prototype.getRenderByIndex=function(e){return this.layout.children[e]},Monominoes.Render.prototype.renderByKey=function(e){for(var n=this,t=new Komunalne.helper.Iterator(e.split("."));t.hasNext()&&(n=n.getMappedRender(t.next())););return n},Monominoes.Render.prototype.inspectRender=function(e){for(var n,t=this,o=new Komunalne.helper.Iterator(e.split("."));o.hasNext()&&(n=o.next(),t=t.getMappedRender(n)||t.getRenderByIndex(n)););return null==t?null:t},Monominoes.Render.prototype.getItemByIndex=function(e){for(var n=new Komunalne.helper.Iterator(Komunalne.util.isInstanceOf(e,"number")?[e]:e.split(".")),t=this.items,o=this,i=null;n.hasNext()&&(Komunalne.util.isInstanceOf(t,Monominoes.Item)&&(i=n.next(),t=t.children[i],o=o.getRenderByIndex(i)),null!=t);)if(o.isIterable()){if(!n.hasNext())break;t=t[n.next()]}else t=t[0];return null==t?null:t},Monominoes.Render.prototype.getItemByKey=function(e){for(var n,t=new Komunalne.helper.Iterator(e.split(".")),o=this,i=this,s=null;t.hasNext()&&(i=i.childMap?i.childMap[s=t.next()]:i.items,null!=i);){if(null!=s&&(o=o.getMappedRender(s)),o.isIterable()){if(!t.hasNext())break;n=t.next()}else n=0;i=i[n]}return void 0===i?null:i},Monominoes.Render.prototype.customize=function(e){},Monominoes.Render.prototype.getBaseRender=function(){var e;if(null==this.baseRender){for(e=this;null!=e.parent;)e=e.parent;this.baseRender=e}return this.baseRender},Monominoes.Render.extend=function(e){var n=this,t=function o(e){return Komunalne.util.isInstanceOf(this,o)?this.init(e):new o(e)};return Komunalne.util.clone(n.prototype,{into:t.prototype,deep:!0}),Komunalne.util.clone(e,{into:t.prototype,deep:!0}),t.extend=Monominoes.Render.extend,t["class"]=t,t.superclass=n,t.prototype["class"]=t,t.prototype.superclass=n,t},Monominoes.Tag=function(e){if(Komunalne.util.isInstanceOf(e,"string"))this.name=e,this.requireEnd=Monominoes.Tag.requireEnd(e);else{if(null==e||!Komunalne.util.isInstanceOf(e,"object"))throw Monominoes.util.format(Monominoes.Tag.invalidArguments,null==e?e:typeof e);if(!("name"in e))throw Monominoes.Tag.missingName;this.name=e.name,this.requireEnd=e.noEnd===!0?!1:Monominoes.Tag.requireEnd(e.name)}this.tag=Monominoes.util.format(this.template(),this.name)},Monominoes.Tag.invalidArguments="Invalid constructor argument type: {0}",Monominoes.Tag.missingName="Missing name in tag configuration",Monominoes.Tag.prototype.template=function(){return this.requireEnd?Monominoes.Tag.open:Monominoes.Tag.full},Monominoes.Tag.prototype.build=function(e){var n;return e=e||{},n=$(this.tag).addClass(e["class"]||"").attr(e.attrs||{}).css(e.style||{}),Komunalne.util.forEach(e.events||{},function(e,t){n.on(t,e)}),null!=e.text&&Komunalne.$.elementText(n,e.text),n},Monominoes.Tag.content=["address","article","header","h1","h2","h3","h4","h5","h6","nav","section"],Monominoes.Tag.text=["dl","dd","div","dl","dt","hr","li","main","ol","p","pre","ul"],Monominoes.Tag.inline=["a","abbr","b","br","cite","code","data","em","i","mark","q","span","strong","sub","sup","time","u","var"],Monominoes.Tag.embed=["embed","iframe","img","object"],Monominoes.Tag.form=["button","form","input","label","legend","output","textarea"],Monominoes.Tag.noend=["hr","br","img","input","embed"],Monominoes.Tag.requireEnd=function(e){return!Komunalne.util.arrayContains(e,this.noend)},Monominoes.Tag.open="<{0}>",Monominoes.Tag.full=Monominoes.Tag.open+"</{0}>",function(){var e=Monominoes.Tag;e.all=Komunalne.util.arrayConcat(e.content,e.text,e.inline,e.embed,e.form);var n;for(var t in e.all)n=e.all[t],Monominoes.tags[n.toUpperCase()]=new Monominoes.Tag(n)}(),Monominoes.renders.TAG=Monominoes.Render.extend({tag:null,def:null,defaultcss:null,extracss:null,text:null,buildItem:function(e,n){var t=Komunalne.util.clone(this.config.def||{},{deep:!0});return t["class"]=t["class"]||this.defaultcss,t.extracss=this.extracss,t.data=e,t.text=this.text||t.text,this.preConfig(t,n),this.buildConfig(t,n),this.postConfig(t,n),this.tag.build(t)},preConfig:function(e,n){},postConfig:function(e,n){},buildConfig:function(e,n){var t=Monominoes.util.extractValue,o=this,i=e.data;delete e.data;var s=function(e,s,r){r[s]=t(e,o,n,i)},r=function(e,t,i){i[t]=e.bind(o,n)};e["class"]=Komunalne.util.append(t(e["class"],this,n,i),t(e.extracss,this,n,i)),delete e.extracss,e.text=t(e.text,this,n,i),e.attrs&&Komunalne.util.forEach(e.attrs,s),e.style&&Komunalne.util.forEach(e.style,s),e.events&&Komunalne.util.forEach(e.events,r)}}),function(){var e;for(var n in Monominoes.tags)e=Monominoes.tags[n],Monominoes.renders[n]=Monominoes.renders.TAG.extend({tag:e,defaultcss:Monominoes.util.format("monominoes-{0}",e.name),name:n})}(),Monominoes.renders.LIST=Monominoes.renders.TAG.extend({name:"LIST",ordered:!1,itemsLayout:null,marker:null,buildLayout:function(){var e;this.tag=this.ordered===!0?Monominoes.tags.OL:Monominoes.tags.UL,this.defaultcss=Monominoes.util.format("monominoes-{0}",this.tag.name),this.itemsLayout=this.itemsLayout||{},void 0!=this.marker&&this.marker!==!0&&(this.marker===!1&&(this.marker="none"),"string"==typeof this.marker&&(this.itemsLayout.def=this.itemsLayout.def||{},this.itemsLayout.def.style=this.itemsLayout.def.style||{},this.itemsLayout.def.style["list-style-type"]=this.marker)),e=Komunalne.util.clone(this.itemsLayout,{into:{iterable:!0},deep:!0,safe:!0}),this.config.children=[{render:Monominoes.renders.LI,config:e}],this["super"].buildLayout()}}),Monominoes.renders.IMAGE_BLOCK=Monominoes.renders.DIV.extend({name:"IMAGE_BLOCK",align:"center",valign:"middle",sourceDir:null,defaultImg:null,extension:null,imgLayout:null,sourceFn:function(e,n,t){var o,i,s,r,l,a;return null!=t?(o=Monominoes.util.extractValue(this.sourceDir,this,n,t)||"",i=this.extension||"",l=o[o.length-1],l=""!=o&&"/"!==l&&"\\"!==l?"/":"",r=""!=i&&"."!=i[0]?".":"",s=t.toString(),a=Monominoes.util.format("{0}{1}{2}{3}{4}",o,l,s,r,i)):a=this.defaultImg,a},errorHandler:function(e){var n;return null!=this.defaultImg?(e.onerror="",e.target.src=this.defaultImg,n=!0):n=!1,n},buildLayout:function(){var e,n,t;this.config.def=this.config.def||{},this.config.def.style=this.config.def.style||{},this.align&&(this.config.def.style["text-align"]=this.align),n={def:{"class":"monominoes-spanimgblock",style:{}}},this.imgLayout=this.imgLayout||{},this.imgLayout.def=this.imgLayout.def||{},this.imgLayout.def.attrs=this.imgLayout.def.attrs||{},this.imgLayout.def.attrs.src=this.sourceFn.bind(this),this.imgLayout.def["class"]=Komunalne.util.append(this.imgLayout.def["class"],"monominoes-imgblock"),e=Komunalne.util.clone(this.imgLayout,{deep:!0}),t=function(e){for(;"IMAGE_BLOCK"!=e.name;)e=e.parent;return e},e.buildItem=function(e,n){var o,i=t(this);return o=this.defaults.buildItem(e,n),o.error(i.errorHandler.bind(i)),o},this.valign&&(n.def.style["vertical-align"]=this.valign,e.def.style=e.style||{},e.def.style["vertical-align"]=this.valign),this.config.children=[new Monominoes.renders.SPAN(n),new Monominoes.renders.IMG(e)],this["super"].buildLayout()}}),Monominoes.renders.TEXT_BLOCK=Monominoes.renders.SPAN.extend({name:"TEXT_BLOCK",defaultcss:"monominoes-text-block",fontcolor:null,background:null,bold:!0,buildLayout:function(){this.config.def=this.config.def||{},this.config.def.style=this.config.def.style||{},this.fontcolor&&(this.config.def.style.color=this.fontcolor),this.background&&(this.config.def.style["background-color"]=this.background),this.config.def.style["font-weight"]=this.bold===!0?"700":"400",this.text=this.text||Monominoes.util.data,this["super"].buildLayout()}}),Monominoes.renders.YOUTUBE=Monominoes.renders.IFRAME.extend({width:480,height:360,buildLayout:function(){this.config.def=this.config.def||{},this.config.def.attrs=this.config.def.attrs||{},this.config.def.attrs.frameborder="0",this.config.def.attrs.allowfullscreen="",this.config.def.attrs.src=this.getUrl,this.config.def.attrs.width=this.width,this.config.def.attrs.height=this.height,this["super"].buildLayout()},getUrl:function(e,n,t){var o=t,i="http://www.youtube.com/embed/";return o.indexOf("watch?")>=0?i+o.substr(o.lastIndexOf("=")+1):o}}),Monominoes.bs={},Monominoes.bs.GRID=Monominoes.renders.DIV.extend({name:"BOOTSTRAP_GRID",defaultcss:"container",grid:null,cell:null,gridcss:null,buildGridSystem:function(){var e=["lg","md","sm","xs"],n="",t=this.grid,o=1;return e.forEach(function(e){var i=Math.abs(parseInt(t[e]));isNaN(i)||(i%=12,0==i&&(i=12),n=Komunalne.util.append(n,Monominoes.util.format("col-{0}-{1}",e,12/i)),i>o&&(o=i))}),this.cols=o,""!=n?n:"col-lg-1"},buildLayout:function(){this.gridcss=this.gridcss||{},this.grid=this.grid||{lg:1},this.cell=this.cell||{},this.cell.def=this.cell.def||{},this.cell.def["class"]=this.buildGridSystem(),this.cell.extracss=this.gridcss.cols||"",this.cell.iterable=!0,this.cell.key="col",this.config.children=[{render:Monominoes.renders.DIV,config:{key:"row",def:{"class":"row"},extracss:this.gridcss.rows||"",iterable:!0,children:[{render:Monominoes.renders.DIV,config:this.cell}]}}],this["super"].buildLayout()},extractData:function(e){var n,t;for(e=this["super"].extractData(e),e=Komunalne.util.isArray?e:[e],n=[],t=0;t<e.length;)n.push(e.slice(t,t+this.cols)),t+=this.cols;return n}}),Monominoes.fa={},Monominoes.fa.ICON=Monominoes.renders.I.extend({name:"FA_ICON",icon:Monominoes.util.data,size:"","fixed-width":!1,border:!1,pull:"",animated:"",rotate:"",flip:"",color:"",background:"",buildItem:function(e,n){var t,o,i,s="",r=function(e,n){return Komunalne.util.append(e,Monominoes.util.format("fa-{0}",n))};return this.config.def=this.config.def||{},this.config.def.style=this.config.def.style||{},this.config.def.style.color=this.color||this.config.def.style.color,this.config.def.style["background-color"]=this.background||this.config.def.style["background-color"],o=this["super"].buildItem(e,n),t=this,i={},Komunalne.util.forEach(["size","pull","animated","rotate","flip","icon"],function(o){i[o]=Monominoes.util.extractValue(t[o],t,n,e)}),s=Komunalne.util.append("fa",o.attr("class")),s=r(s,i.icon),s=Komunalne.util.isAnyOf(i.size,"lg","2x","3x","4x","5x")?r(s,i.size):s,s=Komunalne.util.isAnyOf(i.pull,"left","right")?r(s,"pull-"+i.pull):s,s=Komunalne.util.isAnyOf(i.animated,"pulse","spin")?r(s,i.animated):s,s=Komunalne.util.isAnyOf(i.rotate,"90","180","270")?r(s,"rotate-"+i.rotate):s,s=Komunalne.util.isAnyOf(i.flip,"horizontal","vertical")?r(s,"flip-"+i.flip):s,s=this["fixed-width"]===!0?r(s,"fw"):s,s=this.border===!0?r(s,"border"):s,o.addClass(s),o}});